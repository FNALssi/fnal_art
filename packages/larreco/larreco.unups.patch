diff --git a/CMakeLists.txt b/CMakeLists.txt
index 9e86472..2dc98d5 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -12,16 +12,10 @@ cmake_minimum_required (VERSION 3.12...3.14 FATAL_ERROR)
 
 project(larreco LANGUAGES CXX)
 
-# cetbuildtools contains our cmake modules
-SET ( CETBUILDTOOLS_VERSION $ENV{CETBUILDTOOLS_VERSION} )
-IF (NOT CETBUILDTOOLS_VERSION)
-    MESSAGE (FATAL_ERROR "ERROR: setup cetbuildtools to get the cmake modules")
-ENDIF()
-
-set(CMAKE_MODULE_PATH $ENV{CANVAS_ROOT_IO_DIR}/Modules
-		      $ENV{CETBUILDTOOLS_DIR}/Modules
-		      ${CMAKE_MODULE_PATH})
-
+set(fw_dir config_data)
+set(fcl_dir job)
+set(gdml_dir gdml)
+find_package( cetmodules )
 include(CetCMakeEnv)
 cet_cmake_env()
 
@@ -34,23 +28,8 @@ cet_set_compiler_flags(DIAGS CAUTIOUS
 cet_report_compiler_flags()
 
 # these are minimum required versions, not the actual product versions
-find_ups_product( larcoreobj )
-find_ups_product( larcorealg )
-find_ups_product( larcore )
-find_ups_product( lardataobj )
-find_ups_product( lardataalg )
-find_ups_product( lardata )
-find_ups_product( larevt )
-find_ups_product( larsim )
-find_ups_product( nutools )
-find_ups_product( nug4 )
-find_ups_product( nurandom )
-find_ups_product( art )
-find_ups_product(art_root_io)
-find_ups_product( cetbuildtools )
-find_ups_product( postgresql )
-find_ups_product( range )
-find_ups_product( eigen )
+find_package( ROOT REQUIRED COMPONENTS GenVector Geom Minuit Minuit2 XMLIO Gdml TMVA EG VMC)
+find_package( larsim REQUIRED  )
 
 # macros for dictionary and simple_plugin
 include(ArtDictionary)
@@ -62,9 +41,9 @@ add_subdirectory(larreco)
 
 # tests
 add_subdirectory(test)
-
+add_subdirectory(cmakeConfig)
 # ups - table and config files
-add_subdirectory(ups)
+#add_subdirectory(ups)
 
 # packaging utility
-include(UseCPack)
+#include(UseCPack)
diff --git a/cmakeConfig/CMakeLists.txt b/cmakeConfig/CMakeLists.txt
new file mode 100644
index 0000000..0070c86
--- /dev/null
+++ b/cmakeConfig/CMakeLists.txt
@@ -0,0 +1,4 @@
+
+# create package configuration and version files
+
+cet_cmake_config(CONFIG_FRAGMENTS larreco-fragment.cmake.in)
diff --git a/cmakeConfig/larreco-fragment.cmake.in b/cmakeConfig/larreco-fragment.cmake.in
new file mode 100644
index 0000000..8fdb424
--- /dev/null
+++ b/cmakeConfig/larreco-fragment.cmake.in
@@ -0,0 +1,2 @@
+find_package( ROOT REQUIRED COMPONENTS GenVector Geom Minuit Minuit2 XMLIO Gdml TMVA EG VMC)
+find_package( larsim REQUIRED  )
diff --git a/larreco/ClusterFinder/TrackShowerSplitter/CMakeLists.txt b/larreco/ClusterFinder/TrackShowerSplitter/CMakeLists.txt
index d862f36..c1e72f6 100644
--- a/larreco/ClusterFinder/TrackShowerSplitter/CMakeLists.txt
+++ b/larreco/ClusterFinder/TrackShowerSplitter/CMakeLists.txt
@@ -8,7 +8,7 @@ simple_plugin(TrackShowerHits   "module"
 		 	larcorealg_Geometry
 			larcore_Geometry_Geometry_service
 			lardata_Utilities
-               ${ART_FRAMEWORK_CORE}
+                        ${ART_FRAMEWORK_CORE}
 			${ART_FRAMEWORK_PRINCIPAL}
 			${ART_FRAMEWORK_SERVICES_REGISTRY}
          		${ART_ROOT_IO_TFILE_SUPPORT} ROOT::Core
@@ -18,7 +18,6 @@ simple_plugin(TrackShowerHits   "module"
 			art_Utilities
 			canvas
 			${MF_MESSAGELOGGER}
-
 			cetlib cetlib_except
 			${ROOT_BASIC_LIB_LIST}
 
diff --git a/larreco/HitFinder/HitFinderTools/CMakeLists.txt b/larreco/HitFinder/HitFinderTools/CMakeLists.txt
index 8c3cdc7..ffeb47f 100644
--- a/larreco/HitFinder/HitFinderTools/CMakeLists.txt
+++ b/larreco/HitFinder/HitFinderTools/CMakeLists.txt
@@ -14,18 +14,17 @@ set( hitfinder_tool_lib_list
                         art_Persistency_Provenance
                         ${ART_FRAMEWORK_SERVICES_BASIC}
                         ${ART_ROOT_IO_TFILE_SUPPORT} ROOT::Core
-            ${ART_FRAMEWORK_SERVICES_OPTIONAL_RANDOMNUMBERGENERATOR_SERVICE}
+                        ${ART_FRAMEWORK_SERVICES_OPTIONAL_RANDOMNUMBERGENERATOR_SERVICE}
                         ${ART_ROOT_IO_TFILESERVICE_SERVICE}
                         ${ART_FRAMEWORK_SERVICES_SYSTEM_FILECATALOGMETADATA_SERVICE}
                         art_Utilities
                         canvas
                         ${MF_MESSAGELOGGER}
-
                         ${FHICLCPP}
                         ${CETLIB}
                         Boost::filesystem
-            ${CLHEP}
-                        ${ROOT_BASIC_LIB_LIST}
+                        ${CLHEP_LIBRARIES}
+                        ${ROOT_LIBRARIES}
     )
 
 include(FindOpenMP)
diff --git a/larreco/RecoAlg/CMakeLists.txt b/larreco/RecoAlg/CMakeLists.txt
index 03e524d..9575b4b 100644
--- a/larreco/RecoAlg/CMakeLists.txt
+++ b/larreco/RecoAlg/CMakeLists.txt
@@ -25,3 +25,4 @@ add_subdirectory(xml)
 install_headers()
 install_fhicl()
 install_source()
+
diff --git a/larreco/RecoAlg/Cluster3DAlgs/CMakeLists.txt b/larreco/RecoAlg/Cluster3DAlgs/CMakeLists.txt
index c04c80d..c422c69 100644
--- a/larreco/RecoAlg/Cluster3DAlgs/CMakeLists.txt
+++ b/larreco/RecoAlg/Cluster3DAlgs/CMakeLists.txt
@@ -1,5 +1,5 @@
 cet_enable_asserts()
-
+set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-int-in-bool-context")
 add_subdirectory(ConvexHull)
 add_subdirectory(Voronoi)
 add_subdirectory(PathFinding)
diff --git a/larreco/RecoAlg/ClusterRecoUtil/CMakeLists.txt b/larreco/RecoAlg/ClusterRecoUtil/CMakeLists.txt
index d4a33ac..6d60148 100644
--- a/larreco/RecoAlg/ClusterRecoUtil/CMakeLists.txt
+++ b/larreco/RecoAlg/ClusterRecoUtil/CMakeLists.txt
@@ -1,6 +1,6 @@
 art_make(LIB_LIBRARIES
            lardata_Utilities
-           ${ROOT_BASIC_LIB_LIST}
+           ${ROOT_LIBRARIES}
         )
 
 install_headers()
diff --git a/larreco/RecoAlg/ImagePatternAlgs/CMakeLists.txt b/larreco/RecoAlg/ImagePatternAlgs/CMakeLists.txt
index 3e6d45b..060e055 100644
--- a/larreco/RecoAlg/ImagePatternAlgs/CMakeLists.txt
+++ b/larreco/RecoAlg/ImagePatternAlgs/CMakeLists.txt
@@ -1,2 +1 @@
-
 add_subdirectory(DataProvider)
diff --git a/larreco/RecoAlg/TCAlg/TCDebugTools/CMakeLists.txt b/larreco/RecoAlg/TCAlg/TCDebugTools/CMakeLists.txt
index 9f44bce..1d2c42a 100644
--- a/larreco/RecoAlg/TCAlg/TCDebugTools/CMakeLists.txt
+++ b/larreco/RecoAlg/TCAlg/TCDebugTools/CMakeLists.txt
@@ -2,5 +2,5 @@
 cet_make_exec( rsf_evd
                SOURCE showertree.C
                LIBRARIES
-               ${ROOT_BASIC_LIB_LIST}
+               ${ROOT_LIBRARIES}
                )
diff --git a/larreco/SpacePointFinder/CMakeLists.txt b/larreco/SpacePointFinder/CMakeLists.txt
index e45d650..b10bfd8 100644
--- a/larreco/SpacePointFinder/CMakeLists.txt
+++ b/larreco/SpacePointFinder/CMakeLists.txt
@@ -1,9 +1,11 @@
-include_directories ( $ENV{G4INCLUDE} )
+include(${Geant4_USE_FILE})
+include_directories ( ${Geant4_INCLUDE_DIRS} )
+set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${Geant4_CXX_FLAGS} -Wno-shadow -Wno-unused-parameter")
 
 art_make(MODULE_LIBRARIES
            larreco_RecoAlg
            ${MF_MESSAGELOGGER}
-         )
+        )
 install_headers()
 install_fhicl()
 install_source()
diff --git a/larreco/TrackFinder/CMakeLists.txt b/larreco/TrackFinder/CMakeLists.txt
index 600f4df..7ca8fab 100644
--- a/larreco/TrackFinder/CMakeLists.txt
+++ b/larreco/TrackFinder/CMakeLists.txt
@@ -1,4 +1,7 @@
-include_directories ($ENV{G4INCLUDE})
+include(${Geant4_USE_FILE})
+include_directories ( ${Geant4_INCLUDE_DIRS} )
+set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${Geant4_CXX_FLAGS} -Wno-shadow -Wno-unused-parameter -Wno-ignored-qualifiers")
+set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-misleading-indentation -Wno-maybe-uninitialized -Wno-overloaded-virtual")
 
 art_make(EXCLUDE
            Track3DKalman_module.cc
diff --git a/larreco/VertexFinder/CMakeLists.txt b/larreco/VertexFinder/CMakeLists.txt
index 2046a63..d6ab611 100644
--- a/larreco/VertexFinder/CMakeLists.txt
+++ b/larreco/VertexFinder/CMakeLists.txt
@@ -1,3 +1,5 @@
+set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-misleading-indentation -Wno-maybe-uninitialized -Wno-overloaded-virtual")
+
 art_make(EXCLUDE FeatureVertexFinder_module.cc
          MODULE_LIBRARIES
            larsim_MCCheater_ParticleInventoryService_service
diff --git a/test/HitFinder/CMakeLists.txt b/test/HitFinder/CMakeLists.txt
index 04eb516..d358dcd 100644
--- a/test/HitFinder/CMakeLists.txt
+++ b/test/HitFinder/CMakeLists.txt
@@ -8,7 +8,7 @@ include(CetTest)
 cet_enable_asserts()
 
 cet_test(HitAnaAlg_test USE_BOOST_UNIT
-			LIBRARIES larreco_HitFinder
+                        LIBRARIES larreco_HitFinder
 )
 
 #cet_test(standalone_test)
